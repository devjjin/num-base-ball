<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>숫자야구게임</title>
  </head>
  <body>
    <script>
      // 무작위 숫자 생성
      const generateAnswer = () => {
        const answer = [];
        while (answer.length < 3) {
          const num = Math.floor(Math.random() * 10);
          if (!answer.includes(num)) {
            answer.push(num);
          }
        }
        return answer;
      };

      // 입력 검증
      const checkInput = input => {
        if (input.length !== 3 || isNaN(input)) {
          alert('숫자 3자리만 입력 가능합니다. 다시 입력해주세요.');
          return false;
        }
        if (new Set(input).size !== 3) {
          alert('중복된 숫자는 입력 불가합니다. 다시 입력해주세요.');
          return false;
        }
        return true;
      };

      // 게임 실행하는 함수
      const playBaseball = () => {
        const answer = generateAnswer();
        alert('컴퓨터가 숫자를 생성하였습니다. 답을 맞춰보세요!');

        let round = 1;
        let input;

        while (true) {
          input = prompt(round === 1 ? `${round} 번째 시도` : `${round} 번째 시도 이전값 ${input}`);
          
          if (!input) {
            break;
          }
          if (!checkInput(input)) {
            continue;
          }

          let strikeCnt = 0;
          let ballCnt = 0;

          for (let j = 0; j < answer.length; j++) {
            const idx = input.indexOf(answer[j]);
            if (idx !== -1) {
              // 하나라도 같은게 있다면!
              if (idx === j) {
                strikeCnt++;
              } else {
                ballCnt++;
              }
            }
          }

          if (strikeCnt === 3) {
            alert(`${round}번만에 성공하셨습니다.`);
            break;
          } else {
            alert(`${strikeCnt}S${ballCnt}B`);
          }
          round++;
        }
      };

      playBaseball();
    </script>
  </body>
</html>