<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>숫자야구게임</title>

    <script>
      // 1. 랜덤 숫자 만들기
      //(0~9사이 무작위로 서로 다른 숫자 3개)g
      const answerArr = [];
      
      while (answerArr.length < 3) {
        const num = Math.floor(Math.random() * 10);
        // 중복 되지 않도록 (해당 랜덤숫자가 없을때만 answer 정답배열에 push)
        if (answerArr.indexOf(num) === -1) {
          answerArr.push(num);
        }
      }
      // console.log(answerArr);

      //2. 한자리 숫자에 대해 볼, 스크라이크 판단 하는 부분 구현하기
      // - 숫자의 값과 위치가 모  두 일치하면 S
      // - 숫자의 값은 일치하지만 위치가 틀렸으면 B
      alert('컴퓨터가 숫자를 생성하였습니다. 답을 맞춰보세요!');

      let input;
      let round = 1;


      const checkNum = input => {

        // 3자리아니거나 타입이 숫자아니면
        if (input.length !== 3 || isNaN(input)) {
          // 숫자면isNaN false / 숫자가아니면 true
          alert('숫자 3자리만 입력가능합니다. 다시 입력해주세요');
          return;
        }

        // 숫자 중복체크
        if (new Set(input).size !== 3) {
          alert('중복된 숫자는 입력불가합니다. 다시 입력해주세요.');
        }

        return true;
      };

      // 사용자에게 값 받아오기
      while (true) {
          round === 1 ? (input = prompt(`${round} 번째 시도`)) : (input = prompt(`${round} 번째 시도 이전값 ${input}`));
          
          // 입력값 검증
          if (!checkNum(input)) {
            continue;
          }
          
          // 취소버튼, 공백 null,undefined false로.
          if(!input) break;
          
          let strikeCnt = 0;
          let ballCnt = 0;

          for (let j = 0; j < answerArr.length; j++) {
            const idx = input.indexOf(answerArr[j]);
            if (input.includes(answerArr[j])) {
              // 하나라도 같은게 있다면!
              if (idx === j) {
                strikeCnt++;
              } else {
                ballCnt++;
              }
            }
          }

          // 결과 출력
          if (strikeCnt === 3) {
            alert(`${round}번만에 성공하셨습니다.`);
            break;
          } else {
            alert(`${strikeCnt}S${ballCnt}B`);
          }
          round++;
        }
    </script>
  </head>
  <body></body>
</html>
